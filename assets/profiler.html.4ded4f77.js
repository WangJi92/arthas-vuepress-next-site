import{_ as l,a as t}from"./arthas-output-svg.018486dd.js";import{_ as i,r as d,o,c,a as e,b as n,F as p,d as a,e as r}from"./app.1edb3735.js";const u={},h=e("h1",{id:"profiler",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#profiler","aria-hidden":"true"},"#"),a(" profiler")],-1),b={href:"https://arthas.aliyun.com/doc/arthas-tutorials.html?language=cn&id=command-profiler",target:"_blank",rel:"noopener noreferrer"},m=e("code",null,"profiler",-1),f=a("\u5728\u7EBF\u6559\u7A0B"),g=a("\u4F7F\u7528"),v={href:"https://github.com/jvm-profiling-tools/async-profiler",target:"_blank",rel:"noopener noreferrer"},_=a("async-profiler"),x=a("\u751F\u6210\u706B\u7130\u56FE"),k=r(`<p><code>profiler</code> \u547D\u4EE4\u652F\u6301\u751F\u6210\u5E94\u7528\u70ED\u70B9\u7684\u706B\u7130\u56FE\u3002\u672C\u8D28\u4E0A\u662F\u901A\u8FC7\u4E0D\u65AD\u7684\u91C7\u6837\uFF0C\u7136\u540E\u628A\u6536\u96C6\u5230\u7684\u91C7\u6837\u7ED3\u679C\u751F\u6210\u706B\u7130\u56FE\u3002</p><p><code>profiler</code> \u547D\u4EE4\u57FA\u672C\u8FD0\u884C\u7ED3\u6784\u662F <code>profiler action [actionArg]</code></p><h3 id="\u53C2\u6570\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570\u8BF4\u660E" aria-hidden="true">#</a> \u53C2\u6570\u8BF4\u660E</h3><table><thead><tr><th style="text-align:right;">\u53C2\u6570\u540D\u79F0</th><th style="text-align:left;">\u53C2\u6570\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:right;"><em>action</em></td><td style="text-align:left;">\u8981\u6267\u884C\u7684\u64CD\u4F5C</td></tr><tr><td style="text-align:right;"><em>actionArg</em></td><td style="text-align:left;">\u5C5E\u6027\u540D\u6A21\u5F0F</td></tr><tr><td style="text-align:right;">[i:]</td><td style="text-align:left;">\u91C7\u6837\u95F4\u9694\uFF08\u5355\u4F4D\uFF1Ans\uFF09\uFF08\u9ED8\u8BA4\u503C\uFF1A10&#39;000&#39;000\uFF0C\u537310 ms\uFF09</td></tr><tr><td style="text-align:right;">[f:]</td><td style="text-align:left;">\u5C06\u8F93\u51FA\u8F6C\u50A8\u5230\u6307\u5B9A\u8DEF\u5F84</td></tr><tr><td style="text-align:right;">[d:]</td><td style="text-align:left;">\u8FD0\u884C\u8BC4\u6D4B\u6307\u5B9A\u79D2</td></tr><tr><td style="text-align:right;">[e:]</td><td style="text-align:left;">\u8981\u8DDF\u8E2A\u54EA\u4E2A\u4E8B\u4EF6\uFF08cpu, alloc, lock, cache-misses\u7B49\uFF09\uFF0C\u9ED8\u8BA4\u662Fcpu</td></tr></tbody></table><h3 id="\u542F\u52A8profiler" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8profiler" aria-hidden="true">#</a> \u542F\u52A8profiler</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ profiler start
Started [cpu] profiling
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u751F\u6210\u7684\u662Fcpu\u7684\u706B\u7130\u56FE\uFF0C\u5373event\u4E3A<code>cpu</code>\u3002\u53EF\u4EE5\u7528<code>--event</code>\u53C2\u6570\u6765\u6307\u5B9A\u3002</p></blockquote><h3 id="\u83B7\u53D6\u5DF2\u91C7\u96C6\u7684sample\u7684\u6570\u91CF" tabindex="-1"><a class="header-anchor" href="#\u83B7\u53D6\u5DF2\u91C7\u96C6\u7684sample\u7684\u6570\u91CF" aria-hidden="true">#</a> \u83B7\u53D6\u5DF2\u91C7\u96C6\u7684sample\u7684\u6570\u91CF</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ profiler getSamples
23
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="\u67E5\u770Bprofiler\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bprofiler\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770Bprofiler\u72B6\u6001</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler status
[cpu] profiling is running for 4 seconds
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u53EF\u4EE5\u67E5\u770B\u5F53\u524Dprofiler\u5728\u91C7\u6837\u54EA\u79CD<code>event</code>\u548C\u91C7\u6837\u65F6\u95F4\u3002</p><h3 id="\u505C\u6B62profiler" tabindex="-1"><a class="header-anchor" href="#\u505C\u6B62profiler" aria-hidden="true">#</a> \u505C\u6B62profiler</h3><h4 id="\u751F\u6210html\u683C\u5F0F\u7ED3\u679C" tabindex="-1"><a class="header-anchor" href="#\u751F\u6210html\u683C\u5F0F\u7ED3\u679C" aria-hidden="true">#</a> \u751F\u6210html\u683C\u5F0F\u7ED3\u679C</h4><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u7ED3\u679C\u6587\u4EF6\u662F<code>html</code>\u683C\u5F0F\uFF0C\u4E5F\u53EF\u4EE5\u7528<code>--format</code>\u53C2\u6570\u6307\u5B9A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler stop --format html
profiler output file: /tmp/test/arthas-output/20211207-111550.html
OK
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u6216\u8005\u5728<code>--file</code>\u53C2\u6570\u91CC\u7528\u6587\u4EF6\u540D\u6307\u540D\u683C\u5F0F\u3002\u6BD4\u5982<code>--file /tmp/result.html</code> \u3002</p><h3 id="\u901A\u8FC7\u6D4F\u89C8\u5668\u67E5\u770Barthas-output\u4E0B\u9762\u7684profiler\u7ED3\u679C" tabindex="-1"><a class="header-anchor" href="#\u901A\u8FC7\u6D4F\u89C8\u5668\u67E5\u770Barthas-output\u4E0B\u9762\u7684profiler\u7ED3\u679C" aria-hidden="true">#</a> \u901A\u8FC7\u6D4F\u89C8\u5668\u67E5\u770Barthas-output\u4E0B\u9762\u7684profiler\u7ED3\u679C</h3>`,18),y=a("\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Carthas\u4F7F\u75283658\u7AEF\u53E3\uFF0C\u5219\u53EF\u4EE5\u6253\u5F00\uFF1A "),j={href:"http://localhost:3658/arthas-output/",target:"_blank",rel:"noopener noreferrer"},q=a("http://localhost:3658/arthas-output/"),S=a(" \u67E5\u770B\u5230"),$=e("code",null,"arthas-output",-1),w=a("\u76EE\u5F55\u4E0B\u9762\u7684profiler\u7ED3\u679C\uFF1A"),L=r('<p><img src="'+l+'" alt=""></p><p>\u70B9\u51FB\u53EF\u4EE5\u67E5\u770B\u5177\u4F53\u7684\u7ED3\u679C\uFF1A</p><p><img src="'+t+`" alt=""></p><blockquote><p>\u5982\u679C\u662Fchrome\u6D4F\u89C8\u5668\uFF0C\u53EF\u80FD\u9700\u8981\u591A\u6B21\u5237\u65B0\u3002</p></blockquote><h3 id="profiler\u652F\u6301\u7684events" tabindex="-1"><a class="header-anchor" href="#profiler\u652F\u6301\u7684events" aria-hidden="true">#</a> profiler\u652F\u6301\u7684events</h3><p>\u5728\u4E0D\u540C\u7684\u5E73\u53F0\uFF0C\u4E0D\u540C\u7684OS\u4E0B\u9762\uFF0C\u652F\u6301\u7684events\u5404\u6709\u4E0D\u540C\u3002\u6BD4\u5982\u5728macos\u4E0B\u9762\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler list
Basic events:
  cpu
  alloc
  lock
  wall
  itimer
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u5728linux\u4E0B\u9762</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler list
Basic events:
  cpu
  alloc
  lock
  wall
  itimer
Perf events:
  page-faults
  context-switches
  cycles
  instructions
  cache-references
  cache-misses
  branches
  branch-misses
  bus-cycles
  L1-dcache-load-misses
  LLC-load-misses
  dTLB-load-misses
  mem:breakpoint
  trace:tracepoint
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div>`,9),B=a("\u5982\u679C\u9047\u5230OS\u672C\u8EAB\u7684\u6743\u9650/\u914D\u7F6E\u95EE\u9898\uFF0C\u7136\u540E\b\u7F3A\u5C11\u90E8\u5206event\uFF0C\u53EF\u4EE5\u53C2\u8003"),A=e("code",null,"async-profiler",-1),C=a("\u672C\u8EAB\u6587\u6863\uFF1A"),N={href:"https://github.com/jvm-profiling-tools/async-profiler",target:"_blank",rel:"noopener noreferrer"},V=a("async-profiler"),E=r(`<p>\u53EF\u4EE5\u7528<code>--event</code>\u53C2\u6570\u6307\u5B9A\u8981\u91C7\u6837\u7684\u4E8B\u4EF6\uFF0C\u6BD4\u5982\u5BF9<code>alloc</code>\u4E8B\u4EF6\u8FDB\u5165\u91C7\u6837\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler start --event alloc
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u6062\u590D\u91C7\u6837" tabindex="-1"><a class="header-anchor" href="#\u6062\u590D\u91C7\u6837" aria-hidden="true">#</a> \u6062\u590D\u91C7\u6837</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler resume
Started [cpu] profiling
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>start</code>\u548C<code>resume</code>\u7684\u533A\u522B\u662F\uFF1A<code>start</code>\u662F\u65B0\u5F00\u59CB\u91C7\u6837\uFF0C<code>resume</code>\u4F1A\u4FDD\u7559\u4E0A\u6B21<code>stop</code>\u65F6\u7684\u6570\u636E\u3002</p><p>\u901A\u8FC7\u6267\u884C<code>profiler getSamples</code>\u53EF\u4EE5\u67E5\u770Bsamples\u7684\u6570\u91CF\u6765\u9A8C\u8BC1\u3002</p><h3 id="\u4F7F\u7528execute\u6765\u6267\u884C\u590D\u6742\u7684\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528execute\u6765\u6267\u884C\u590D\u6742\u7684\u547D\u4EE4" aria-hidden="true">#</a> \u4F7F\u7528<code>execute</code>\u6765\u6267\u884C\u590D\u6742\u7684\u547D\u4EE4</h3><p>\u6BD4\u5982\u5F00\u59CB\u91C7\u6837\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>profiler execute &#39;start,framebuf=5000000&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u505C\u6B62\u91C7\u6837\uFF0C\u5E76\u4FDD\u5B58\u5230\u6307\u5B9A\u6587\u4EF6\u91CC\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>profiler execute &#39;stop,file=/tmp/result.html&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,11),F=a("\u5177\u4F53\u7684\u683C\u5F0F\u53C2\u8003\uFF1A "),I={href:"https://github.com/jvm-profiling-tools/async-profiler/blob/v2.5/src/arguments.cpp#L50",target:"_blank",rel:"noopener noreferrer"},O=a("arguments.cpp"),P=r(`<h3 id="\u67E5\u770B\u6240\u6709\u652F\u6301\u7684action" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u6240\u6709\u652F\u6301\u7684action" aria-hidden="true">#</a> \u67E5\u770B\u6240\u6709\u652F\u6301\u7684action</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler actions
Supported Actions: [resume, dumpCollapsed, getSamples, start, list, execute, version, stop, load, dumpFlat, actions, dumpTraces, status]
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="\u67E5\u770B\u7248\u672C" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u7248\u672C" aria-hidden="true">#</a> \u67E5\u770B\u7248\u672C</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ profiler version
Async-profiler 1.6 built on Sep  9 2019
Copyright 2019 Andrei Pangin
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="\u914D\u7F6E-framebuf-\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E-framebuf-\u53C2\u6570" aria-hidden="true">#</a> \u914D\u7F6E framebuf \u53C2\u6570</h3><blockquote><p>\u5982\u679C\u9047\u5230\u751F\u6210\u7684\u706B\u7130\u56FE\u6709 <code>[frame_buffer_overflow]</code>\uFF0C\u5219\u9700\u8981\u589E\u5927 framebuf\uFF08\u9ED8\u8BA4\u503C\u662F 1&#39;000&#39;000\uFF09\uFF0C\u53EF\u4EE5\u663E\u5F0F\u914D\u7F6E\uFF0C\u6BD4\u5982\uFF1A</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>profiler start --framebuf 5000000
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u914D\u7F6E-include-exclude-\u6765\u8FC7\u6EE4\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E-include-exclude-\u6765\u8FC7\u6EE4\u6570\u636E" aria-hidden="true">#</a> \u914D\u7F6E include/exclude \u6765\u8FC7\u6EE4\u6570\u636E</h3><p>\u5982\u679C\u5E94\u7528\u6BD4\u8F83\u590D\u6742\uFF0C\u751F\u6210\u7684\u5185\u5BB9\u5F88\u591A\uFF0C\u60F3\u53EA\u5173\u6CE8\u90E8\u5206\u6570\u636E\uFF0C\u53EF\u4EE5\u901A\u8FC7 include/exclude \u6765\u8FC7\u6EE4\u3002\u6BD4\u5982</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>profiler start --include &#39;java/*&#39; --include &#39;demo/*&#39; --exclude &#39;*Unsafe.park*&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>include/exclude \u90FD\u652F\u6301\u8BBE\u7F6E\u591A\u4E2A\u503C \uFF0C\u4F46\u662F\u9700\u8981\u914D\u7F6E\u5728\u547D\u4EE4\u884C\u7684\u6700\u540E\u3002</p></blockquote><h3 id="\u6307\u5B9A\u6267\u884C\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#\u6307\u5B9A\u6267\u884C\u65F6\u95F4" aria-hidden="true">#</a> \u6307\u5B9A\u6267\u884C\u65F6\u95F4</h3><p>\u6BD4\u5982\uFF0C\u5E0C\u671Bprofiler\u6267\u884C 300 \u79D2\u81EA\u52A8\u7ED3\u675F\uFF0C\u53EF\u4EE5\u7528 <code>-d</code>/<code>--duration</code> \u53C2\u6570\u6307\u5B9A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>profiler start --duration 300
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u751F\u6210-jfr\u683C\u5F0F\u7ED3\u679C" tabindex="-1"><a class="header-anchor" href="#\u751F\u6210-jfr\u683C\u5F0F\u7ED3\u679C" aria-hidden="true">#</a> \u751F\u6210 jfr\u683C\u5F0F\u7ED3\u679C</h3><blockquote><p>\u6CE8\u610F\uFF0Cjfr\u53EA\u652F\u6301\u5728 <code>start</code>\u65F6\u914D\u7F6E\u3002\u5982\u679C\u662F\u5728<code>stop</code>\u65F6\u6307\u5B9A\uFF0C\u5219\u4E0D\u4F1A\u751F\u6548\u3002</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>profiler start --file /tmp/test.jfr
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>file</code>\u53C2\u6570\u652F\u6301\u4E00\u4E9B\u53D8\u91CF\uFF1A</p><ul><li>\u65F6\u95F4\u6233\uFF1A <code>--file /tmp/test-%t.jfr</code></li><li>\u8FDB\u7A0BID\uFF1A <code>--file /tmp/test-%p.jfr</code></li></ul><p>\u751F\u6210\u7684\u7ED3\u679C\u53EF\u4EE5\u7528\u652F\u6301jfr\u683C\u5F0F\u7684\u5DE5\u5177\u6765\u67E5\u770B\u3002\u6BD4\u5982\uFF1A</p><ul><li>JDK Mission Control \uFF1A https://github.com/openjdk/jmc</li><li>JProfiler \uFF1A https://github.com/alibaba/arthas/issues/1416</li></ul><h3 id="\u751F\u6210\u7684\u706B\u7130\u56FE\u91CC\u7684-unknown" tabindex="-1"><a class="header-anchor" href="#\u751F\u6210\u7684\u706B\u7130\u56FE\u91CC\u7684-unknown" aria-hidden="true">#</a> \u751F\u6210\u7684\u706B\u7130\u56FE\u91CC\u7684 unknown</h3><ul><li>https://github.com/jvm-profiling-tools/async-profiler/discussions/409</li></ul>`,23);function T(D,J){const s=d("ExternalLinkIcon");return o(),c(p,null,[h,e("p",null,[e("a",b,[m,f,n(s)])]),e("blockquote",null,[e("p",null,[g,e("a",v,[_,n(s)]),x])]),k,e("p",null,[y,e("a",j,[q,n(s)]),S,$,w]),L,e("p",null,[B,A,C,e("a",N,[V,n(s)])]),E,e("p",null,[F,e("a",I,[O,n(s)])]),P],64)}var U=i(u,[["render",T],["__file","profiler.html.vue"]]);export{U as default};
